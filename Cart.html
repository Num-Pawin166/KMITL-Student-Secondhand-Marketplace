<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô - KMITL Marketplace</title>
    
    <!-- ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Auth Guard ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ -->
    <!-- <script src="auth.js"></script> -->

    <link rel="stylesheet" href="Cart.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- (‡∏™‡πà‡∏ß‡∏ô Header ‡πÅ‡∏•‡∏∞ Main ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) -->
     <div class="container">
        <header>
            <a href="index.html" class="logo-link" style="font-weight: bold; font-size: 1.2rem;">KMITL Marketplace</a>
            <div class="search-bar">
                <input type="text" placeholder="Search for products...">
            </div>
            <a href="add-product.html" class="post-item-btn"><i class="fas fa-plus-circle"></i> ‡∏•‡∏á‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
            <div class="header-icons">
                <a href="Cart.html" class="icon-link"><i class="fas fa-shopping-cart"></i></a>
                <a href="dashboard.html" class="icon-link"><i class="fas fa-user"></i></a>
            </div>
        </header>

        <main>
            <h2><i class="fas fa-shopping-cart"></i> ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
            <div class="cart">
                <div class="cart-items-list" id="cart-items-list">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡πÇ‡∏î‡∏¢ JavaScript -->
                </div>

                <div class="summary">
                    <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h3>
                    <div class="summary-item">
                        <span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (Subtotal)</span>
                        <span id="subtotal">0 ‡∏ø</span>
                    </div>
                    <div class="summary-item">
                        <span>‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á (Shipping)</span>
                        <span id="shipping">0 ‡∏ø</span>
                    </div>
                    <hr>
                    <div class="summary-item total">
                        <span>‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Total)</span>
                        <span id="total">0 ‡∏ø</span>
                    </div>
                    <button class="checkout-btn">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
                </div>
            </div>
        </main>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const cartListContainer = document.getElementById('cart-items-list');
        const subtotalEl = document.getElementById('subtotal');
        const shippingEl = document.getElementById('shipping');
        const totalEl = document.getElementById('total');
        const shippingCost = 50; // ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á

        const cartManager = {
            getCart: function() {
                return JSON.parse(localStorage.getItem('shoppingCart')) || [];
            },
            saveCart: function(cart) {
                localStorage.setItem('shoppingCart', JSON.stringify(cart));
                renderCart(); // <-- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å render ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            },
            removeItem: function(productId) {
                let cart = this.getCart();
                cart = cart.filter(item => item.id !== productId);
                this.saveCart(cart);
            },
            updateQuantity: function(productId, change) {
                let cart = this.getCart();
                const item = cart.find(item => item.id === productId);
                if (item) {
                    item.quantity += change;
                    if (item.quantity <= 0) {
                        this.removeItem(productId);
                    } else {
                        this.saveCart(cart);
                    }
                }
            }
        };

        function renderCart() {
            const cart = cartManager.getCart();
            cartListContainer.innerHTML = '';
            let subtotal = 0;

            if (cart.length === 0) {
                cartListContainer.innerHTML = '<p>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</p>';
                subtotalEl.textContent = '0 ‡∏ø';
                shippingEl.textContent = '0 ‡∏ø';
                totalEl.textContent = '0 ‡∏ø';
                return;
            }

            cart.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'cart-item';
                
                subtotal += item.price * item.quantity;

                itemDiv.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div class="item-info">
                        <strong>${item.name}</strong><br>
                        ‡∏£‡∏≤‡∏Ñ‡∏≤: ${item.price.toLocaleString()} ‡∏ø
                    </div>
                    <div class="item-controls">
                        <button class="quantity-btn decrease-btn" data-id="${item.id}">-</button>
                        <span>${item.quantity}</span>
                        <button class="quantity-btn increase-btn" data-id="${item.id}">+</button>
                        <button class="remove-btn" data-id="${item.id}">üóëÔ∏è</button>
                    </div>
                `;
                cartListContainer.appendChild(itemDiv);
            });

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°
            subtotalEl.textContent = `${subtotal.toLocaleString()} ‡∏ø`;
            shippingEl.textContent = `${shippingCost.toLocaleString()} ‡∏ø`;
            totalEl.textContent = `${(subtotal + shippingCost).toLocaleString()} ‡∏ø`;
        }

        // --- ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listeners ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ---
        cartListContainer.addEventListener('click', (e) => {
            const target = e.target;
            const productId = parseInt(target.dataset.id);

            if (target.classList.contains('remove-btn')) {
                cartManager.removeItem(productId);
            }
            if (target.classList.contains('decrease-btn')) {
                cartManager.updateQuantity(productId, -1);
            }
            if (target.classList.contains('increase-btn')) {
                cartManager.updateQuantity(productId, 1);
            }
        });

        // --- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ---
        renderCart();
    });
</script>
</body>
</html>